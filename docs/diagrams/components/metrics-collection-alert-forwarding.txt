title Metrics Collection and AlertForwarding

bottomparticipants

participant "hub\nalertmanager" as halrt
participant "external\nmetrics\nendpoint\n(optional)\n(e.g., victoriametrics)" as ext
participant "Thanos\nReceive" as rec
participant "observatorium\napi\ngateway" as gw

participant "endpoint\noperator" as ep
participant "cluster\nmonitoring\nconfig\n(configmap)" as cmc #orange
participant "metrics\ncollector/\nuwl metrics\ncollector" as mcol
participant "prometheus/\nuwl prometheus" as prom #orange
participant "cmo\noperator" as cmo #orange

mcol-#red>prom:scrapes metrics
mcol-#red>gw:send metrics (remote write API)
gw-#red>rec:forward\nmetrics
gw-#red>ext:forward\nmetrics\n(if configured)
ep->cmc:inject\nadditional\nalermanager\nconfig
cmo-->cmc:watches
cmo->prom:updates
prom-#green>halrt:forward alerts
